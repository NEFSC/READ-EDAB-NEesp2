<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Creating Spatial Indicator Time Series with EDAB_Utilities • NEesp2</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creating Spatial Indicator Time Series with EDAB_Utilities">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">NEesp2</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-about-esp" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">About ESP</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-about-esp">
<li><a class="dropdown-item" href="../articles/why-esp.html">Why ESP?</a></li>
    <li><a class="dropdown-item" href="../articles/indicator-sources.html">Indicator Sources for Northeast ESPs</a></li>
    <li><a class="dropdown-item" href="../articles/esp-links.html">Northeast ESP Links</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-vignettes" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Vignettes</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-vignettes">
<li><a class="dropdown-item" href="../articles/install-and-use-package.html">Install and Use Package</a></li>
    <li><a class="dropdown-item" href="../articles/general-workflow.html">General Workflow</a></li>
    <li><a class="dropdown-item" href="../articles/rmarkdown-intro.html">RMarkdown Intro</a></li>
    <li><a class="dropdown-item" href="../articles/using_edab_utils.html">Using EDAB-Utils R package</a></li>
    <li><a class="dropdown-item" href="../articles/accessing-survdat-data.html">Accessing Bottom Trawl Survey Data</a></li>
    <li><a class="dropdown-item" href="../articles/using_mrip_data.html">Using MRIP Data for Recreational Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/using_survdat_data.html">Using {survdat} for Bottom Trawl Indicators</a></li>
    <li><a class="dropdown-item" href="../articles/compare_condition.html">Comparison of condition data methods</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="nav-link" href="../mailto:stephanie.owen@noaa.gov"><span class="fa fas fa-paper-plane fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NEFSC/READ-EDAB-NEesp2/issues/"><span class="fa fas fa-question-circle fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/NEFSC/READ-EDAB-NEesp2"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://nmfs-general-modeling-tools.github.io/"><span class="fa fa-fish"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Creating Spatial Indicator Time Series with EDAB_Utilities</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/NEFSC/READ-EDAB-NEesp2/blob/HEAD/vignettes/create-spatial-indicator-time-series.Rmd" class="external-link"><code>vignettes/create-spatial-indicator-time-series.Rmd</code></a></small>
      <div class="d-none name"><code>create-spatial-indicator-time-series.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="creating-spatial-indicators">Creating Spatial Indicators<a class="anchor" aria-label="anchor" href="#creating-spatial-indicators"></a>
</h2>
<p>The function NEesp::create_spatial_indicator generates a
spatially-aggregated time series from a netCDF file. The function passes
data through EDABUtilities::make_2d_summary_ts, which provides summary
statistics of 2d gridded data as time series by area and outputs as a
data frame.</p>
<p>This function has been tested with GLORYS bottom temperature and
salinity data, OCCCI chlorophyll and mean primary production data, and
OISST sea surface temperature data. All test input files can be found in
‘data-raw’ in this package.</p>
<div class="section level3">
<h3 id="glorys-bottom-temperature">GLORYS Bottom Temperature<a class="anchor" aria-label="anchor" href="#glorys-bottom-temperature"></a>
</h3>
<p>Setting file.time = annual and agg.time = days returns a daily value
for a netCDF on a daily time step.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glorys_bt</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_spatial_indicator.html">create_spatial_indicator</a></span><span class="op">(</span>indicator_name <span class="op">=</span> <span class="st">"bottomT"</span>, </span>
<span>                               units <span class="op">=</span> <span class="st">"degC"</span>,</span>
<span>                               data.in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'glorys_bottomT.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               file.time <span class="op">=</span> <span class="st">'annual'</span>,</span>
<span>                               output.files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'GLORYS_monthly_bottomT.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                               shp.file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw/shapefiles'</span>,<span class="st">'EPU_NOESTUARIES.shp'</span><span class="op">)</span>,</span>
<span>                               var.name <span class="op">=</span> <span class="st">'bottomT'</span>,</span>
<span>                               area.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MAB'</span>,<span class="st">'GB'</span><span class="op">)</span>,</span>
<span>                               statistic <span class="op">=</span> <span class="st">'mean'</span>,</span>
<span>                               agg.time <span class="op">=</span> <span class="st">'days'</span>,</span>
<span>                               tz <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                               touches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                               write.out <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">glorys_bt</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="glorys-bottom-salinity">GLORYS Bottom Salinity<a class="anchor" aria-label="anchor" href="#glorys-bottom-salinity"></a>
</h3>
<p>Setting file.time = annual and agg.time = days returns a daily value
for a netCDF on a daily time step.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glorys_sal</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_spatial_indicator.html">create_spatial_indicator</a></span><span class="op">(</span>indicator_name <span class="op">=</span> <span class="st">'bottomS'</span>,</span>
<span>                                units <span class="op">=</span> <span class="st">'1e-3'</span>,</span>
<span>                                data.in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'glorys_bottomS.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                output.files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'GLORYS_daily_bottomS.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                file.time <span class="op">=</span> <span class="st">'annual'</span>,</span>
<span>                                shp.file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw/shapefiles'</span>,<span class="st">'EPU_NOESTUARIES.shp'</span><span class="op">)</span>,</span>
<span>                                var.name <span class="op">=</span> <span class="st">'bottomS'</span>,</span>
<span>                                area.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MAB'</span>,<span class="st">'GB'</span><span class="op">)</span>,</span>
<span>                                statistic <span class="op">=</span> <span class="st">'mean'</span>,</span>
<span>                                agg.time <span class="op">=</span> <span class="st">'days'</span>,</span>
<span>                                tz <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                touches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                write.out <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">glorys_sal</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="occci-chlorophyll-a">OCCCI Chlorophyll-a<a class="anchor" aria-label="anchor" href="#occci-chlorophyll-a"></a>
</h3>
<p>Setting file.time = annual and agg.time = days returns a monthly
value for a netCDF on a monthly time step.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occci_chl</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_spatial_indicator.html">create_spatial_indicator</a></span><span class="op">(</span>indicator_name <span class="op">=</span> <span class="st">'chlor_a'</span>,</span>
<span>                                units <span class="op">=</span> <span class="st">'milligram m-3'</span>,</span>
<span>                                data.in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'occci_test2.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                output.files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'occci_chl.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                file.time <span class="op">=</span> <span class="st">'annual'</span>,</span>
<span>                                shp.file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw/shapefiles'</span>,<span class="st">'EPU_NOESTUARIES.shp'</span><span class="op">)</span>,</span>
<span>                                var.name <span class="op">=</span> <span class="st">'bottomS'</span>,</span>
<span>                                area.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MAB'</span>,<span class="st">'GB'</span><span class="op">)</span>,</span>
<span>                                statistic <span class="op">=</span> <span class="st">'mean'</span>,</span>
<span>                                agg.time <span class="op">=</span> <span class="st">'days'</span>,</span>
<span>                                tz <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                touches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                write.out <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occci_chl</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="occci-primary-production">OCCCI Primary Production<a class="anchor" aria-label="anchor" href="#occci-primary-production"></a>
</h3>
<p>Setting file.time = annual and agg.time = days returns a monthly
value for a netCDF on a monthly time step.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">occci_primprod</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_spatial_indicator.html">create_spatial_indicator</a></span><span class="op">(</span>indicator_name <span class="op">=</span> <span class="st">"primary_production_mean"</span>,</span>
<span>                units <span class="op">=</span> <span class="st">'gCarbon/m^2/day'</span>,</span>
<span>                data.in <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'pp_occci_199798.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                file.time <span class="op">=</span> <span class="st">'annual'</span>,</span>
<span>                output.files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'OCCCI_PRIM_PROD.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                shp.file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw/shapefiles'</span>,<span class="st">'EPU_NOESTUARIES.shp'</span><span class="op">)</span>,</span>
<span>                var.name <span class="op">=</span> <span class="st">'primary productivity'</span>,</span>
<span>                area.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MAB'</span>,<span class="st">'GB'</span><span class="op">)</span>,</span>
<span>                statistic <span class="op">=</span> <span class="st">'mean'</span>,</span>
<span>                agg.time <span class="op">=</span> <span class="st">'days'</span>,</span>
<span>                tz <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                touches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                write.out <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">occci_primprod</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="oisst-sea-surface-temperature">OISST Sea Surface Temperature<a class="anchor" aria-label="anchor" href="#oisst-sea-surface-temperature"></a>
</h3>
<p>OISST data is formatting using a 0-360 longitude. It must be passed
through EDABUtilities::convert_longitude to convert to -180 to +180
longitude before running ‘create_spatial_indicator’</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sst_monthly_converted</span> <span class="op">&lt;-</span> <span class="fu">EDABUtilities</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/EDABUtilities/man/convert_longitude.html" class="external-link">convert_longitude</a></span><span class="op">(</span>data <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw/sst_monthly.nc'</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sst_monthly</span> <span class="op">&lt;-</span> <span class="fu">NEesp2</span><span class="fu">::</span><span class="fu"><a href="../reference/create_spatial_indicator.html">create_spatial_indicator</a></span><span class="op">(</span>indicator_name <span class="op">=</span> <span class="st">'sst'</span>,</span>
<span>                                units <span class="op">=</span> <span class="st">'degC'</span>,</span>
<span>                                data.in <span class="op">=</span> <span class="va">sst_monthly_converted</span>,</span>
<span>                                output.files <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw'</span>,<span class="st">'sst_monthly_test.nc'</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                file.time <span class="op">=</span> <span class="st">'annual'</span>,</span>
<span>                                shp.file <span class="op">=</span> <span class="fu">here</span><span class="fu">::</span><span class="fu"><a href="https://here.r-lib.org/reference/here.html" class="external-link">here</a></span><span class="op">(</span><span class="st">'data-raw/shapefiles'</span>,<span class="st">'EPU_NOESTUARIES.shp'</span><span class="op">)</span>,</span>
<span>                                var.name <span class="op">=</span> <span class="st">'sst'</span>,</span>
<span>                                area.names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'MAB'</span>,<span class="st">'GB'</span><span class="op">)</span>,</span>
<span>                                statistic <span class="op">=</span> <span class="st">'mean'</span>,</span>
<span>                                agg.time <span class="op">=</span> <span class="st">'days'</span>,</span>
<span>                                tz <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>                                touches <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                                write.out <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sst_monthly</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/atyrell3" class="external-link">Abigail Tyrell</a>, <a href="https://github.com/stephanie-owen" class="external-link">Stephanie Owen</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
